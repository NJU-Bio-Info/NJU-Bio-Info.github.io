<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>pca</title>
      <link href="/2023/08/28/pca/"/>
      <url>/2023/08/28/pca/</url>
      
        <content type="html"><![CDATA[<p>���ﱾ������һ�����ӵ���ϵ�����Ǳ���ʹ�ö�ά��������֮����׼ȷ����������һ����������Ϣѧ�������ֵ���Ϊͻ�����Ծ����ת¼������Ϊ����</p><ul><li>bulk RNA-seq��Ϊһ�־���Ļ�����Ա��������������㷺Ӧ���ڸ����о��У����������һ�������ж�4����Ʒ������bulk RNA-seq������ô���ǽ��õ�һ��4*Nά�ľ�������N����ȫ�����鷶Χ����ת¼�Ļ���</li><li>scRNA-seq�ǽ�ʮ�������չ��һ�ֱַ��ʸ��ߵ�RNA-seq��������ǽ��в������֯�����к���10000��ϸ������ô��������󽫵õ�һ��10000*Nά�ľ���</li></ul><p>���ݷ׷����ӣ����ǲ����ܽ����е����ݶ����з����������Ǵ�ʱ��Ϳռ��϶��ǲ���ʵ�ģ������������Ϣѧ��������NGS��ѧ�������ݽ�ά������һ���޷��ӱܵ����⡣</p><p>��ô����ʲô�����ݽ�ά�أ�����˵����ֻ������Щ�ڲ�ͬ����𣨶�bulk RNA-seq���Ծ��ǲ�ͬ����������scRNA-seq���Ծ��ǲ�ͬ��ϸ�����о��нϴ���������������������Щ�ǳ�����һ������������ν�����Ƽ��ա���</p><p>���ݽ�ά������ʲôʵ��Ӧ���أ�һ����򵥵�Ӧ�þ����ҵ�һ��Ⱥ�������Ƶĸ��壬����һ��Ҳ����ҹ㷺��Ӧ�õ�NGS�����������������У�һ����ԣ����ǻ��ͬһ������ѧ������׼���������ѧ�ظ������Ǹ��ڴ���ͬ��Ʒ�����ڲ���С�������죬ֻ����������˵�����ǵ����ݿ��ظ��Ժã�ʵ�����������ȶ���</p><blockquote><h1 id="1-�������ݽ�ά����"><a href="#1-�������ݽ�ά����" class="headerlink" title="1. �������ݽ�ά����"></a>1. �������ݽ�ά����</h1></blockquote><p>����ѧ�е����ݽ�ά�������Ǵӻ���ѧϰ�����������ģ�Ŀǰ���õ���Ҫ�������Խ�ά��PCA��principal component analysis�����ɷַ������������Խ�ά��tSNE��t-Distribution Stochastic Neighbour Embedding����UMAP��Uniform Manifold Approximation and Projection for Dimension Reduction���ȡ�</p><ul><li>PCA��</li></ul><p><a href="https://book.ncrnalab.org/teaching/%EF%BF%BD%EF%BF%BD" title="�廪��ѧ³־ʵ����Bioinformatics Tutorial">PCA����Ҫ˼�����ҵ�k��������ϣ���nά����ͶӰ��kά�ϣ�ʹ���µ�kά�����˴����������ҿ��Ծ����ܶ�Ľ��������е�variation�������õ��µ�kά�����ͱ���Ϊk�����ɷ֡�k�����ɷ�ʵ���϶�Ӧ�����Ǵ��������ݹ��Ƴ���Э�����������k������ֵ��Ӧ������������</a>PCA����������Ϣѧ�����У��������������bulk RNA-seqת¼��Ŀ��ӻ���õķ�����</p><p>Ϊ�˱����ô�Ҹ��õļ�����ʲô��PCA����������������PPT����˵����</p><p><img src="https://files.mdnice.com/user/41526/3e86e7e1-be66-42c0-9807-f98615bd354a.png"></p><p><img src="https://files.mdnice.com/user/41526/127f14dc-0d59-4452-b38e-91c959362d4f.png"></p><ul><li>tSNE��UMAP</li></ul><p>t-SNE��UMAP��Ҫ�����ƾ��Ǳ��ַ����Եľֲ��ṹ���������Ƚ��������������ϴ�����֮���໥��ϵ�Ƚϸ��ӵ����ݣ������ڵ�ϸ��ת¼��Ŀ��ӻ����д���Ӧ�á���Ҫע����ǣ������ֽ�Ϊ�ķ���ͨ��ֻӦ�������ݵĿ��ӻ���</p><blockquote><h1 id="2-����ʵ��"><a href="#2-����ʵ��" class="headerlink" title="2. ����ʵ��"></a>2. ����ʵ��</h1></blockquote><p>�ڱ������ҽ������ݵ�Ԥ��������ά�������ӻ��Ĺ�����R���Խ���չʾ��</p><ul><li><h3 id="����Ԥ����"><a href="#����Ԥ����" class="headerlink" title="����Ԥ����"></a>����Ԥ����</h3></li></ul><p>�ڽ��н�ά����֮ǰ�����ȱ���Ҫ����һ�������������ݵ�Ԥ���������зǳ��ؼ���һ������scale����ʱ���Է���Ϊ����һ������������˵��δ�����������ݿ��ܾ��зǳ���ı���ȣ�����ܻ�Ժ����ķ�������Ӱ�죬������˵����RNA-seqΪ������ͬ�Ļ�����в�ͬ�ı���ˮƽ����Щ�������ˮƽ�ܸߣ��еĺܵͣ�ͬһ�������ڲ�ͬ������ѧ�����±���Ĳ���Ҳ��ͬ���еġ���Ȼ���������еġ��ŷ���������������зǳ���Ĳ��졣��³־��ʦ��tutorial��˵�����漰��������ģ�Ͷ��ԣ���ʵ��Ӧ���У���ͬ��������ֵ��С��ͬ�����������ʱ��ɺܴ��Ӱ�졣���磬һ������ı������ܸߣ���һ������ı������ܵͣ�������������ݵĹ�һ�����������ߵĻ���ͻ���������ļ��㡣</p><p>��R���������ǳ��õľ���ʹ��z-score����й�һ����<br>$$<br>zscore(x_{ij})&#x3D;\frac{x_{ij}-\mu_{ij}}{\sigma_i}<br>$$<br>��������ʹ���β�����ݼ���������ʾ�������ݼ�ΪR��datasets��һ���������ݼ�����¼��150���β����ͬ����������������һ�����ֱ�Ӽ���ʹ�ü��ɣ�</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">head<span class="punctuation">(</span>iris<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span><br><span class="line"><span class="comment">#1          5.1         3.5          1.4         0.2  setosa</span></span><br><span class="line"><span class="comment">#2          4.9         3.0          1.4         0.2  setosa</span></span><br><span class="line"><span class="comment">#3          4.7         3.2          1.3         0.2  setosa</span></span><br><span class="line"><span class="comment">#4          4.6         3.1          1.5         0.2  setosa</span></span><br><span class="line"><span class="comment">#5          5.0         3.6          1.4         0.2  setosa</span></span><br><span class="line"><span class="comment">#6          5.4         3.9          1.7         0.4  setosa</span></span><br></pre></td></tr></table></figure><p>����R���Ե�<code>scale()</code>�������й�һ����</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iris.scale <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>as.matrix<span class="punctuation">(</span>iris<span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                    scale <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span></span><br><span class="line">                    center <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><ul><li><h3 id="���ݽ�ά"><a href="#���ݽ�ά" class="headerlink" title="���ݽ�ά"></a>���ݽ�ά</h3></li></ul><h4 id="1-PCA"><a href="#1-PCA" class="headerlink" title="1. PCA"></a>1. PCA</h4><p>������PCA������������ַ������ֱ����stats����<code>prcomp()</code>������FactoMineR����<code>PCA()</code>������</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#use prcomp()</span></span><br><span class="line">pca.res <span class="operator">&lt;-</span> prcomp<span class="punctuation">(</span>iris.scale<span class="punctuation">,</span> scale. <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> center <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#set FALSE, because we have already done</span></span><br><span class="line">plot.data <span class="operator">&lt;-</span> cbind<span class="punctuation">(</span>as.data.frame<span class="punctuation">(</span>pca.res<span class="operator">$</span>x<span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                   Species <span class="operator">=</span> iris<span class="operator">$</span>Species<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> plot.data<span class="punctuation">,</span> aes<span class="punctuation">(</span>PC1<span class="punctuation">,</span> PC2<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> Species<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_test<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p><img src="https://files.mdnice.com/user/41526/a01dff3d-7c1f-4c32-a7c6-1ff9ad7bfe25.png"><br>���ǿ��Կ���ͬһ�����ֵĲ�ͬ�����������������һ�𣬶���ͬ����֮�䡰��μ����������versicolor��virginicaδ���ܺ÷ֿ�����Ϊ���������ֱ����;������Ƶ�������</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#use PCA()</span></span><br><span class="line"><span class="comment">#install.packages(&#x27;factoextra&#x27;)</span></span><br><span class="line"><span class="comment">#install.packages(&#x27;FactoMineR&#x27;)</span></span><br><span class="line">library<span class="punctuation">(</span>factoextra<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>FactoMineR<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">pca.res <span class="operator">&lt;-</span> PCA<span class="punctuation">(</span>iris.scale<span class="punctuation">,</span> </span><br><span class="line">               scale.unit <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span></span><br><span class="line">               graph <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">fviz_pca_ind<span class="punctuation">(</span>pca.res<span class="punctuation">,</span></span><br><span class="line">             geom <span class="operator">=</span> <span class="string">&#x27;point&#x27;</span><span class="punctuation">,</span></span><br><span class="line">             habillage <span class="operator">=</span> iris<span class="operator">$</span>Species<span class="punctuation">,</span></span><br><span class="line">             addEllipses <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_test<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p><img src="https://files.mdnice.com/user/41526/965ee887-25f2-483e-a6bb-bdf1a1c7e0d8.png"><br>������ƣ���������������PC2�������ˡ����Կ����������������֣�73%��22.9%������Լ�����Ϊÿ�����ɷ��ܹ����͵����ݱ���ȱ���������ǰ���PPT������������PC1���Ͷ���ߣ�PC2��֮�����������ǳ��Կ�һ��PC3��PC4���β����������ֶ���Σ�</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">fviz_pca_ind<span class="punctuation">(</span>pca.res<span class="punctuation">,</span></span><br><span class="line">             axes <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">             geom <span class="operator">=</span> <span class="string">&#x27;point&#x27;</span><span class="punctuation">,</span></span><br><span class="line">             habillage <span class="operator">=</span> iris<span class="operator">$</span>Species<span class="punctuation">,</span></span><br><span class="line">             addEllipses <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_test<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p><img src="https://files.mdnice.com/user/41526/0b239888-92d4-49f0-b28e-cb36c462a069.png"><br>����˵����û�зֿ�ԭ����������������ɷ�û�кܺõĽ����������ݼ��ı���ȣ�3.7%��0.5%����</p><p>���ɣ��������ǿ���������PCA�ķ���������bulk RNA-seq��ͬ����ѧ�����µĲ�ͬ����ѧ�ظ��������ԺͲ����ԣ���ȻDESeq2���������Ҳ���԰���������PCAͼ�������ǻ���Ҫ���ⱳ���ԭ����</p><h4 id="2-tSNE"><a href="#2-tSNE" class="headerlink" title="2. tSNE"></a>2. tSNE</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#install.packages(&#x27;Rtsne&#x27;)</span></span><br><span class="line">library<span class="punctuation">(</span>Rtsne<span class="punctuation">)</span></span><br><span class="line">tsne.res <span class="operator">&lt;-</span> Rtsne<span class="punctuation">(</span>iris.scale<span class="punctuation">,</span> check_duplicates <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">plot.data <span class="operator">&lt;-</span> cbind<span class="punctuation">(</span>as.data.frame<span class="punctuation">(</span>tsne.res<span class="operator">$</span>Y<span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                   Species <span class="operator">=</span> iris<span class="operator">$</span>Species<span class="punctuation">)</span></span><br><span class="line">colnames<span class="punctuation">(</span>plot.data<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;tSNE_1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;tSNE_2&#x27;</span><span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> plot.data<span class="punctuation">,</span> aes<span class="punctuation">(</span>tSNE_1<span class="punctuation">,</span> tSNE_2<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> Species<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_test<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p><img src="https://files.mdnice.com/user/41526/ef427c8c-7d60-4f31-96bb-c67d45f1900d.png"></p><p>���Կ�����ͬ���ֵĲ�ͬ�������ܺõľ�����һ��</p><h4 id="3-UMAP"><a href="#3-UMAP" class="headerlink" title="3. UMAP"></a>3. UMAP</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#install.packages(&#x27;umap&#x27;)</span></span><br><span class="line">library<span class="punctuation">(</span>umap<span class="punctuation">)</span></span><br><span class="line">umap.res <span class="operator">&lt;-</span> umap<span class="punctuation">(</span>iris.scale<span class="punctuation">)</span></span><br><span class="line">plot.data <span class="operator">&lt;-</span> cbind<span class="punctuation">(</span>as.data.frame<span class="punctuation">(</span>umap.res<span class="operator">$</span>layout<span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                   Species <span class="operator">=</span> iris<span class="operator">$</span>Species<span class="punctuation">)</span></span><br><span class="line">colnames<span class="punctuation">(</span>plot.data<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;UMAP_1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;UMAP_2&#x27;</span><span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> plot.data<span class="punctuation">,</span> aes<span class="punctuation">(</span>UMAP_1<span class="punctuation">,</span> UMAP_2<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> Species<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_test<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p><img src="https://files.mdnice.com/user/41526/66988b00-4895-49dc-865a-51c8aefd3042.png"></p><blockquote><h1 id="3-д�����"><a href="#3-д�����" class="headerlink" title="3. д�����"></a>3. д�����</h1></blockquote><p>�Ƽ�һ��ѧϰ��վ���廪��ѧ³־ʵ���ҵ�Bioinformatics Tutorial�����ԭ�ļ�����תŶ��</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>test</title>
      <link href="/2023/08/28/test/"/>
      <url>/2023/08/28/test/</url>
      
        <content type="html"><![CDATA[<p>This is just a test!</p>]]></content>
      
      
      <categories>
          
          <category> test </category>
          
      </categories>
      
      
        <tags>
            
            <tag> just a test </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2023/08/27/hello-world/"/>
      <url>/2023/08/27/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
