<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>wb</title>
      <link href="/2023/09/28/wb/"/>
      <url>/2023/09/28/wb/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Advanced Math - 2</title>
      <link href="/2023/09/13/math-2/"/>
      <url>/2023/09/13/math-2/</url>
      
        <content type="html"><![CDATA[<h1 id="导数"><a href="#导数" class="headerlink" title="导数"></a>导数</h1><ul><li><p>导数：</p><p>若函数$f(x)$在$x=a$的某邻域内有定义，在$x=a$处取$\Delta x$使得$x+\Delta x$仍然在有定义的邻域内，则$f(x)$在$x=a$处的导数可以定义为：（右侧有<strong>有限极限</strong>）</p><script type="math/tex; mode=display">f'(a) = \lim_{\Delta x\rightarrow 0}\frac{f(a + \Delta x)-f(a)}{\Delta x}</script><p>导数的另一种常见定义：</p><script type="math/tex; mode=display">f'(a) = \lim_{x\rightarrow a}\frac{f(x)-f(a)}{x-a}</script><p>导数的几种表示方式：<script type="math/tex">f'(x)</script>；<script type="math/tex">y'</script>；<script type="math/tex">\frac{dy}{dx}</script>；$\frac{d(f(x))}{dx}$。</p><ul><li><p>导数的几何意义：</p><p>$f(x)$在$x=a$处的导数$f’(a)$为曲线$y=f(x)$在点$(a, f(a))$处的切线的斜率，其切线方程为：</p><script type="math/tex; mode=display">y- f(a) = f'(a)(x-a)</script></li><li><p>连续与可导的关系：</p><p><strong>连续不一定可导，但可导一定连续。</strong></p></li><li><p>左导数与右导数：</p><p>左导数：$f_{-}’(a) = \lim_{x\rightarrow a-}\frac{f(x)-f(a)}{x-a}$；</p><p>右导数：$f_{+}’(a) = \lim_{x\rightarrow a+}\frac{f(x)-f(a)}{x-a}$。</p><p>Example: 若偶函数处处可导，请证明其导函数为奇函数。</p><script type="math/tex; mode=display">\begin{aligned}Proof:f'(x) &= \lim_{\Delta x\rightarrow 0}\frac{f(x+\Delta x)-f(x)}{\Delta x} \\&=\lim_{\Delta x\rightarrow 0}\frac{f(-(-x-\Delta x))-f(x)}{\Delta x} \\&=\lim_{\Delta x\rightarrow 0}\frac{f(-x-\Delta x)-f(x)}{\Delta x} \\&=-\lim_{\Delta x\rightarrow 0}\frac{f(-x-\Delta x)-f(x)}{-\Delta x} \\&=-f'(-x)\end{aligned}</script><p>同理可证若一个奇函数处处可导，其导函数也一定为偶函数。</p></li><li><p>常见函数的求导公式</p><ul><li>$(x^\lambda)’=\lambda x^{\lambda -1}$；</li><li>$(a^x)’ = a^x\ln a$；</li><li>$(\log_a|x|)’ = \frac{1}{x\ln a}$；</li><li>$(\sin x)’ = \cos x$；</li><li>$(\cos x)’ = -\sin x$；</li><li>$(\tan x)’ = \sec^2x$；</li><li>$(\cot x)’ = -\csc ^2x$；</li><li>$(\sec x)’ = \sec x \tan x$；</li><li>$(\csc x)’ = -\csc x\cot x$；</li><li>$(\arcsin x)’ = \frac{1}{\sqrt{1-x^2}}$；（稍后给出推导过程）</li><li>$(\arccos x)’ = -\frac{1}{\sqrt{1-x^2}}$；（稍后给出推导过程）</li><li>$(\arctan x)’ = \frac{1}{1+x^2}$；（稍后给出推导过程）</li><li>$(arccotx)’ = -\frac{1}{1+x^2}$。（稍后给出推导过程）</li></ul></li><li><p>求导法则</p><ul><li><p>导数四则运则</p><p>$(u\pm v)’ = u’ \pm v’$；</p><p>$(uv)’ = u’v \pm uv’$；</p><p>$(cu)’ = cu’, c \in R$；</p><p>$(\frac{u}{v})’ = \frac{u’v - uv’}{v^2}, v \ne 0$。</p></li><li><p>复合函数求导法则</p><p>$\frac{d}{dx}f(\varphi(x)) = f’(\varphi(x))\varphi’(x)$</p></li><li><p>反函数求导</p><p>$x=f(y)$在$I_y$内单调可导，且$f’(y)\ne0$，则反函数$y = f^{-1}(x)$的导数为：$[f^{-1}(x)]’ = \frac{1}{f’(y)}$。</p><p><strong>下面使用反函数求导推导$y = \arcsin x$的导数</strong>：</p><script type="math/tex; mode=display">\begin{array}{l}\because y = \arcsin x \\\therefore x = \sin y \\\text{这里}:\frac{dy}{dx} = \frac{1}{\frac{dx}{dy}}  = \frac{1}{\cos y}\\\text考虑到y为三角形的一个内角，其对边为x，斜边为1，故其另一邻边长为\sqrt{1-x^2}; \\\therefore \cos y = \frac{1}{\sqrt{1-x^2}} \\\therefore (\arcsin x)' = \frac{dy}{dx} = \frac{1}{\sqrt{1-x^2}}\end{array}</script></li><li><p>隐函数求导</p><p>直接对$x$进行求导即可。</p><p>例：若$e^y + xy -e = 0$，求$\frac{dy}{dx}$。</p><script type="math/tex; mode=display">\begin{array}{l}\text两边同时对x进行求导:\\e^yy' + y + xy' = 0 \\(e^y+x)y' + y = 0 \\y'=-\frac{y}{e^y+x}\end{array}</script></li><li><p>参数方程求导</p><p>若$\begin{cases}x = \varphi(t)\\y = \psi(t)\end{cases}$，$t$为参数，确定$y$为$x$的函数，则$\frac{dy}{dx} = \frac{\frac{dy}{dt}}{\frac{dx}{dt}}$。</p></li></ul></li></ul></li></ul><h1 id="微分"><a href="#微分" class="headerlink" title="微分"></a>微分</h1><ul><li><p>微分</p><p>若$y=f(x)$在$x=a$的某个邻域内有定义，且存在常数$A$使得当$\Delta x\rightarrow 0$时有：</p><script type="math/tex; mode=display">\Delta y = f(a+\Delta x) - f(a) = A\Delta x + \omicron(\Delta x)</script><p>则称$f(x)$在$x=a$处可微。</p><p>下面证明$A=f’(a)$：</p><script type="math/tex; mode=display">\begin{aligned}f'(a) = \lim_{\Delta x\rightarrow0}\frac{\Delta y}{\Delta x} &= \lim_{\Delta x\rightarrow0}\frac{A\Delta x + \omicron(\Delta x)}{\Delta x} \\&=\lim_{\Delta x\rightarrow0}A+\frac{\omicron(\Delta x)}{\Delta x} \\&=A+\lim_{\Delta x\rightarrow0}\frac{\omicron(\Delta x)}{\Delta x} \\&=A\end{aligned}</script><p>$f(x)$在$x=a$处可微的充要条件为$f(x)$在$x=a$处可导，此时称：</p><script type="math/tex; mode=display">\Delta y \approx dy = f'(a)\Delta x = f'(a)dx</script><p>为$f(x)$在$x=a$处的微分。在这里的近似中，我们忽略了$\omicron(\Delta x)$。</p><ul><li><p>微分中值定理</p><ul><li><p>费马定理</p><p>设函数$f(x)$在$x=a$的某个邻域$I$内有定义，$f(a)$为$f(x)$在$I$上的最值，且$f(x)$在$x=a$处可导，则必有$f’(x) = 0$。</p></li><li><p>罗尔定理</p><p>若函数$f(x)$满足：a. 在$[a,b]$连续；b. 在$(a,b)$可导；c. $f(a)=f(b)$，则至少存在一点$\xi \in (a,b)$使得$f’(\xi)=0$。</p></li><li><p>拉格朗日中值定理</p><p>若函数$f(x)$满足：a. 在$[a,b]$连续；b. 在$(a,b)$可导，则$\exists \xi \in (a,b)$使得$f’(\xi) = \frac{f(a)-f(b)}{a-b}$。</p></li><li><p>柯西中值定理</p><p>若函数$f(x)$与$g(x)$皆在$[a,b]$连续且在$(a,b)$可导，且$g’(x)\ne0$，则$\exists \xi \in (a,b)$使得$\frac{f’(\xi)}{g’(\xi)}=\frac{f(a)-f(b)}{g(a)-g(b)}$。</p></li></ul></li><li><p>四大中值定理证明</p><ul><li><p>费马定理</p><script type="math/tex; mode=display">\begin{array}{l}此处证明当f(a)为函数f(x)在I上的最大值时的情形;\\由于f(x)在x=a处可导,则f(x)在x=a处的左右导数必定相等;\\f_{-}'(a) = \lim_{\Delta x \rightarrow 0^-}\frac{f(a+\Delta x)-f(a)}{\Delta x} \geq 0 \\f_{+}'(a) = \lim_{\Delta x \rightarrow 0^+}\frac{f(a+\Delta x)-f(a)}{\Delta x} \leq 0 \\要使f_{-}'(a)=f_{+}'(a),则必须有f_{-}'(a)=f_{+}'(a)=f'(a) = 0,得证.\end{array}</script></li><li><p>罗尔定理</p><script type="math/tex; mode=display">\begin{array}{l}根据连续函数的最值定理,由于f(x)在[a,b]连续,则f(x)在[a,b]上必定存在最大值M和最小值m;\\下面分情况讨论:\\a. 若M=m,则f(x)在[a,b]内恒为常数,则必定存在一点\xi使得f'(\xi)=0;\\b. 若M在端点处取得,而m不在端点,则根据费马定理,必定\exists \xi\in(a,b),f(\xi)=m，f'(\xi)=0;\\c. 若m在端点处取得,而M不在端点,则根据费马定理,必定\exists \xi\in(a,b),f(\xi)=M，f'(\xi)=0;\\d. 若M和m都不在端点取得,则根据费马定理,必定\exists \xi\in(a,b),f(\xi)=M或m,f'(\xi)=0,得证.\end{array}</script></li><li><p>拉格朗日中值定理</p><script type="math/tex; mode=display">\begin{array}{l}要证明f'(\xi)=\frac{f(a)-f(b)}{a-b};\\即证f(a)-f(b)-f'(\xi)(a-b)=0;\\构造新函数g(x) = [f(a)-f(b)]x-f(x)(a-b);\\g(a) = [f(a)-f(b)]a-f(a)(a-b) = bf(a)-af(b);\\g(b) = [f(a)-f(b)]b-f(b)(a-b) = bf(a)-af(b);\\显然g(a)=g(b)，则根据罗尔定理，必定\exists \xi\in(a,b)使得g'(\xi) = [f(a)-f(b)]-f'(\xi)(a-b)=0;\\即f'(\xi)=\frac{f(a)-f(b)}{a-b},得证.\end{array}</script></li><li><p>柯西中值定理</p><script type="math/tex; mode=display">\begin{array}{l}要证明\frac{f'(\xi)}{g'(\xi)}=\frac{f(a)-f(b)}{g(a)-g(b)};\\即证f'(\xi)-g'(\xi)\frac{f(a)-f(b)}{g(a)-g(b)} = 0;\\构造新函数h(x) = f(x)-g(x)\frac{f(a)-f(b)}{g(a)-g(b)};\\h(a) = f(a)-g(a)\frac{f(a)-f(b)}{g(a)-g(b)}=\frac{g(a)f(b)-f(a)g(b)}{g(a)-g(b)};\\h(b) = f(b)-g(b)\frac{f(a)-f(b)}{g(a)-g(b)}=\frac{g(a)f(b)-f(a)g(b)}{g(a)-g(b)};\\显然h(a)=h(b)，则根据罗尔定理，必定\exists \xi\in(a,b)使得f'(\xi)-g'(\xi)\frac{f(a)-f(b)}{g(a)-g(b)}=0;\\即\frac{f'(\xi)}{g'(\xi)}=\frac{f(a)-f(b)}{g(a)-g(b)},得证.\end{array}</script></li></ul></li></ul></li></ul><h1 id="导数与微分的应用"><a href="#导数与微分的应用" class="headerlink" title="导数与微分的应用"></a>导数与微分的应用</h1><ul><li><p>泰勒展开 （Taylor expansion）</p><p>首先介绍魏尔斯特拉斯定理（Weierstrass定理）：</p><font face="楷体">设函数$f(x)$在闭区间$[a,b]$上连续，则存在多项式序列$\{P_n(x)\}$在$[a,b]$上一致收敛于$f(x)$。也就是对任意给定的$\varepsilon > 0$，存在多项式$P(x)$使得$|P(x)-f(x)|<\varepsilon$，对一切$x\in[a,b]$成立。</font><p>现在，若函数$f(x)$在$x=a$的某邻域$I$上$n+1$阶可导，则对于$\forall x \in I$根据魏尔斯特拉斯定理：</p><script type="math/tex; mode=display">f(x) = a_0+a_1(x-a)+a_2(x-a)^2+\cdots+a_n(x-a)^n+R_n(x)</script><p>其中$R_n(x)$表示逼近的误差，下面对前面不含误差的部分求$n$阶导：</p><script type="math/tex; mode=display">\begin{aligned}f'(x) &= a_1 + 1\cdot2a_2(x-a) + 3a_3(x-a)^2 + \cdots + na_n(x-a)^{(n-1)} \\f''(x) &= 1\cdot2\cdot a_2 + 1\cdot2\cdot3\cdot a_3(x-a) + \cdots + (n-1)\cdot n\cdot (x-a)^{(n-2)} \\f'''(x) &= 1\cdot2\cdot3\cdot a_3 + 1\cdot2\cdot3\cdot4\cdot (x-a) + \cdots + (n-2)\cdot(n-1)\cdot n\cdot (x-a)^{(n-3)}\\\cdots \\f^{(n)}(x) &= 1\cdot2\cdot3\cdots\cdot n\cdot a_n\end{aligned}</script><p>再令所有的$x=a$，就有：</p><script type="math/tex; mode=display">\begin{aligned}a_0 &= f(a) \\a_1 &= f'(a) \\a_2 &= \frac{f''(a)}{2!}\\a_3 &= \frac{f'''(a)}{3!}\\\cdots \\a_n &= \frac{f^{(n)}(a)}{n!}\end{aligned}</script><p>所以函数就可以表示为：</p><script type="math/tex; mode=display">f(x) = f(a)+f'(a)(x-a)+\frac{f''(a)}{2!}(x-a)^2+\frac{f'''(a)}{3!}(x-a)^3+\cdots+\frac{f^{(n)}(a)}{n!}(x-a)^n+R_n(x)</script><p>或者简单表示为：</p><script type="math/tex; mode=display">f(x) = \sum_{k=0}^{n}\frac{f^{(k)}(a)}{k!}(x-a)^k + R_n(x)</script><p>此式称为$f(x)$在$x=a$的$n$阶泰勒展开式，其中$R_n(x)$有两种表示方法：</p><ul><li>皮亚诺余项：$R_n(x) = o((x-a)^n)$；</li><li>拉格朗日余项：$R_n(x) = \frac{f^{(n+1)}(\xi)}{(n+1)!}(x-a)^{(n+1)}$，其中$\xi$介于$x$与$a$之间。</li></ul></li><li><p>洛必达法则</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Advanced math </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Advanced math </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>UCSC Track Hub</title>
      <link href="/2023/08/31/ucsc-hub/"/>
      <url>/2023/08/31/ucsc-hub/</url>
      
        <content type="html"><![CDATA[<p>Two sharp tools to visualize genome data are IGV and <a href="https://genome.ucsc.edu/">UCSC</a>, while the latter one is a web page which can be a potential source for us to share data with other efficiently. So how can we make full use of UCSC in data communication? This blog will tell you the basic tutorial for this topic.</p><div align=center><img src="1.jpg" width=100%></div><h1 id="1-What-are-track-hubs"><a href="#1-What-are-track-hubs" class="headerlink" title="1 What are track hubs?"></a>1 What are track hubs?</h1><p>Track hubs are web-accessible directories of genomic data that can be viewed on the UCSC Genome Browser. Track hubs can be displayed on genomes that UCSC directly supports, or on your own sequence. Hubs are a useful tool for visualizing a large number of genome-wide data sets. For example, a project that has produced several wiggle plots of data can use the hub utility to organize the tracks into composite and super-tracks, making it possible to show the data for a large collection of tissues and experimental conditions in a visually elegant way, similar to how the ENCODE native data tracks are displayed in the browser.</p><p>The track hub utility allows efficient access to data sets from around the world through the familiar Genome Browser interface. Browser users can display tracks from any public track hub that has been registered with UCSC.</p><h1 id="2-Set-your-own-track-hubs"><a href="#2-Set-your-own-track-hubs" class="headerlink" title="2 Set your own track hubs"></a>2 Set your own track hubs</h1><p>In my research field, I only use UCSC to visualize the genome data. So in this part you can only prepare two compartment to create your own track hub.</p><ul><li>one or more data sets formatted in one of the compressed binary index formats supported by the Genome Browser: bigBed, bigBarChart, bigGenePred, bigNarrowPeak, bigPsl, bigChain, bigInteract, bigMaf, bigWig, BAM, CRAM, HAL, hic or VCF.</li><li>a set of text files that specify properties for the track hub and for each of the data tracks within it.</li></ul><p>There is now a <code>useOneFile on</code> hub setting that allows the hub properties to be specified in a single file. Here I will show you how to combine various configuration information into a single file and deposit your data sets in <a href="https://usegalaxy.org/">Galaxy</a>, a free web space.</p><h2 id="2-1-Prepare-configuration-file"><a href="#2-1-Prepare-configuration-file" class="headerlink" title="2.1 Prepare configuration file"></a>2.1 Prepare configuration file</h2><p>The basic properties of configuration file should have three parts: hub information, genome and track description.</p><h3 id="2-1-1-Hub-information"><a href="#2-1-1-Hub-information" class="headerlink" title="2.1.1 Hub information"></a>2.1.1 Hub information</h3><p>This part contains up to six fields that define the properties of the track hub (here I only show you five).</p><pre class=" language-lang-R"><code class="language-lang-R">hub            <hub_name>shortLabel    <hub_short_label>longLabel    <hub_long_label>email        <email_address>useOneFile    on</code></pre><p><em>hub</em> - a single-word name of the directory containing the track hub files.</p><p><em>shortLabel</em> - the short name for the track hub. Suggested maximum length is 17 characters. Displayed as the hub name on the Track Hubs page and the track group name on the browser tracks page.</p><p><em>longLabel</em> - a longer descriptive label for the track hub. Suggested maximum length is 80 characters. Displayed in the description field on the Track Hubs page.</p><p><em>email</em> - the contact to whom questions regarding the track hub should be directed.</p><p><em>useOneFile on</em> - only use this setting if your hub is displaying one genome and if you wish to put all information into only one file: hub.txt.</p><p>This is a simple example:</p><pre class=" language-lang-R"><code class="language-lang-R">hub            H3K4me3_hubshortLabel    H3K4me3 hublongLabel    UCSC track hub for H3K4me3 ChIP dataemail        skm@smail.nju.edu.cnuseOneFile    on</code></pre><h3 id="2-2-2-Genome"><a href="#2-2-2-Genome" class="headerlink" title="2.2.2 Genome"></a>2.2.2 Genome</h3><p>For me, I always use hg38/GRCh38 as the reference genome. So I will only simply add the following single line to hub.txt.</p><pre class=" language-lang-R"><code class="language-lang-R">genome        hg38</code></pre><h3 id="2-2-3-Track-description"><a href="#2-2-3-Track-description" class="headerlink" title="2.2.3 Track description"></a>2.2.3 Track description</h3><p>In this part, I will only introduce you the minimum information to create track description file. Typically speaking, you should at least include the following five lines in this part.</p><pre class=" language-lang-R"><code class="language-lang-R">track        track_namebigDataUrl    track_data_URLshortLabel    short_labellongLabel    long_labeltype        track_type</code></pre><p><em>track</em>: the symbolic name of the track;</p><p><em>bigDataUrl</em>: the file name, path, or Web location of your track files;</p><p><em>shortLabel</em>: the short name for the track displayed in the track list;</p><p><em>longLabel</em>: the longer description label for the track;</p><p><em>type</em>: the format of the file specified by bigDataUrl. Must be either bigWig, bigBed, bigBarChart, bigGenePred, bigInteract, bigNarrowPeak, bigChain, bigPsl, bigMaf, hic, bam, halSnake or vcfTabix.</p><p>For detailed information, such as track color settings, you can </p><h3 id="2-2-4-Integrate-into-one-file"><a href="#2-2-4-Integrate-into-one-file" class="headerlink" title="2.2.4 Integrate into one file"></a>2.2.4 Integrate into one file</h3><p>Now, you can integrate all of the information above into a single file named <em>hub.txt</em>. The following is an example:</p><pre class=" language-lang-R"><code class="language-lang-R">hub        H3K4me3_hubshortLabel    H3K4me3 hublongLabel    UCSC track hub for H3K4me3 ChIP dataemail    skm@smail.nju.edu.cnuseOneFile    ongenome    hg38track    H3K4me3bigDataUrl    <file path>shortLabel    The H3K4me3 tracklongLabel    The H3K4me3 CUT&Tag tracktype    bigWig</code></pre><h2 id="2-2-Upload-your-data"><a href="#2-2-Upload-your-data" class="headerlink" title="2.2 Upload your data"></a>2.2 Upload your data</h2><p>We can notice that the <em>bigDataUrl</em> contains file path information. So how can we pass our data to UCSC track hub? Web space galaxy gives us an optimal choice.</p><p>Firstly, you should sign up for a galaxy account and then you can sign in it with your user name and password information. Then you can upload your data from local space to it.</p><div align=center><img src="2.jpg" width=100%></div><div align=center><img src="3.jpg" width=100%></div><p>After set type and reference genome information, you can click start to start uploading. Once you finish this work, the right panel of the web page should be a list of your files. Copy this link and paste it in <em>hub.txt</em> described before to provide the file path information.</p><div align=center><img src="4.jpg" width=50%></div># 3 Share track hubsNow, you can share your track hubs with others. The most important file in this part is *hub.txt*, which should also be uploaded to galaxy.Firstly, enter UCSC and click My Data to enter Track Hubs and then you can choose asia mirror to speed up.<div align=center><img src="5.jpg" width=100%></div><div align=center><img src="6.jpg" width=60%></div><p>Enter your url information of <em>hub.txt</em> here and then you can connect your own track hubs. And the url information can be obtained like the <em>bigDataUrl</em> described before.</p><div align=center><img src="7.jpg" width=100%></div><p>If you succeed, you will get a page:</p><div align=center><img src="8.jpg" width=100%></div><p>Click <em>hg38</em> and then you can view your own track in UCSC and if you want to share them with others, just tell others your <em>hub.txt</em> url and do like what you do. Finally, they will connect to your track hub as well.</p>]]></content>
      
      
      <categories>
          
          <category> Genome Biology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Genome biology </tag>
            
            <tag> UCSC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cell culture</title>
      <link href="/2023/08/29/cell-culture/"/>
      <url>/2023/08/29/cell-culture/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Reagents-list"><a href="#1-Reagents-list" class="headerlink" title="1 Reagents list"></a>1 Reagents list</h1><ul><li>DMEM High glucose, Hyclone, Cat #SH30243.01</li><li>FBS, QuaCell, Cat #B21001</li><li>Penicillin-Streptomycin Solution (100X), Beyotime, Cat #C0222</li><li>PBS, Beyotime, Cat #C0221A</li><li>Trypsin-EDTA Solution with phenol red, Beyotime, Cat #C0203</li><li>Updating…</li></ul><h1 id="2-Buffer-Prepare"><a href="#2-Buffer-Prepare" class="headerlink" title="2 Buffer Prepare"></a>2 Buffer Prepare</h1><h2 id="2-1-HEK293T-culture-medium"><a href="#2-1-HEK293T-culture-medium" class="headerlink" title="2.1 HEK293T culture medium"></a>2.1 HEK293T culture medium</h2><ul><li><p>90% v/v DMEM High glucose;</p></li><li><p>10% v/v FBS;</p></li><li><p>1% v/v Penicillin-Streptomycin Solution (100X).</p><p>Store at 4 degreeC.</p></li></ul><h1 id="3-Experimental-Procedure"><a href="#3-Experimental-Procedure" class="headerlink" title="3 Experimental Procedure"></a>3 Experimental Procedure</h1><h2 id="3-2-HEK293T"><a href="#3-2-HEK293T" class="headerlink" title="3.2 HEK293T"></a>3.2 HEK293T</h2><ol><li>Remove the culture medium;</li><li>Wash the cells with warm PBS (without disturb cells);</li><li>Add 1mL Trypsin-EDTA Solution with phenol red to the cells per 10 cm culture dish;</li><li>Incubate at 37 degreeC for 2 min;</li><li>Use 9mL culture medium to flush the cells down totally;</li><li>Centrifuge for 5 min at 200g, R.T.;</li><li>After remove the supernatant, use 10mL culture medium to resuspend the cell pellet;</li><li>Seed the cells to a new 10 cm dish and culture them at 37 degreeC, 5% CO<sub>2</sub>.</li></ol>]]></content>
      
      
      <categories>
          
          <category> Experiment </category>
          
          <category> Cell </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Experimental protocol </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RNA extraction</title>
      <link href="/2023/08/29/RNA-extract/"/>
      <url>/2023/08/29/RNA-extract/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Reagents-list"><a href="#1-Reagents-list" class="headerlink" title="1 Reagents list"></a>1 Reagents list</h1><ul><li>RNA isolater Total RNA Extraction Reagent, Vazyme, Cat #R401-01</li><li>FreeZol Reagent, Vazyme, Cat #R711 (alternative)</li><li>100% ethanol (EtOH)</li><li>100% isopropanol (IPA)</li><li>DEPC H<sub>2</sub>O, Beyotime, Cat #R0021</li><li>1.5mL RNase-free EP tube</li><li>RNase-free pipettor</li><li>ice</li></ul><h1 id="2-Buffer-Prepare"><a href="#2-Buffer-Prepare" class="headerlink" title="2 Buffer Prepare"></a>2 Buffer Prepare</h1><ul><li>75% EtOH (in DEPC H<sub>2</sub>O)</li></ul><h1 id="3-Experimental-Procedure"><a href="#3-Experimental-Procedure" class="headerlink" title="3 Experimental Procedure"></a>3 Experimental Procedure</h1><p><strong><em>Caution: this protocol is only applicable for cell RNA extraction.</em></strong> For tissue sample, you should follow another.</p><h2 id="3-1-Cell-lysis"><a href="#3-1-Cell-lysis" class="headerlink" title="3.1 Cell lysis"></a>3.1 Cell lysis</h2><p><strong>Use 6-cell plate and FreeZol Reagent as example.</strong></p><ol><li>Add 500uL FreeZol to the cells and incubate at R.T. for 5 min;</li><li>Use 1mL pipettor to mix the system well and then transfer to a RNase-free tube;</li><li>Incubate at R.T. for 5 min.</li></ol><h2 id="3-2-RNA-isoloation"><a href="#3-2-RNA-isoloation" class="headerlink" title="3.2 RNA isoloation"></a>3.2 RNA isoloation</h2><ol><li><p>Add 150uL Dilution Buffer to the system and then vortex for 5 s;</p></li><li><p>Incubate at R.T. for 5 min;</p></li><li><p>Centrifuge for 15 min at 12,000xg, 4 degreeC;</p></li><li><p>Gently transfer the supernatant to a new RNase-free tube (~500 uL);</p></li><li><p>Add same volume of 100% IPA to the supernatant, shake by hand to mix well;</p></li><li><p><strong><em>[Optional]</em></strong> <em>Incubate at -20 degreeC at least 30 min;</em></p><p><u><strong>From now on, all steps should be performed on ice.</strong></u></p></li><li><p>Centrifuge for 10 min at 12,000xg, 4 degreeC;</p></li><li><p>Gently remove the supernatant without disturbing the RNA pellet;</p></li><li><p>Gently add 1mL 75% EtOH (in DEPC H<sub>2</sub>O) and invert up-and-down;</p></li><li><p>Centrifuge for 5 min at 12,000xg, 4 degreeC;</p></li><li><p>Repeat 8~10 again;</p></li><li><p>Gently remove the supernatant without disturbing the RNA pellet;</p><p><em>Tips: here you can use flash to totally remove the residual EtOH, which may influence downstream experiment.</em></p></li><li><p>Air dry the RNA pellet for 5 min.</p><p><em>Caution: not to let the RNA pellet dry completely as this will greatly decrease its solubility.</em></p></li><li><p>Dissolve RNA with 50uL DEPC H<sub>2</sub>O and then use NanoDrop to check the concentration and quality;</p><p><em>Note: ideally A<sub>260</sub></em>/A<sub>280</sub> &gt; 2.0 and A<sub>260</sub>/A<sub>230</sub> &gt; 2.2.</p></li><li><p>Store RNA at -80 degreeC and avoid repeated freeze-thaw.</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> RNA biology </category>
          
          <category> Experiment </category>
          
          <category> RNA </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RNA biology </tag>
            
            <tag> Experimental protocol </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Advanced Math - 1</title>
      <link href="/2023/08/29/math-1/"/>
      <url>/2023/08/29/math-1/</url>
      
        <content type="html"><![CDATA[<h1 id="极限"><a href="#极限" class="headerlink" title="极限"></a>极限</h1><ul><li><p>函数的在某点的极限</p><p>若<script type="math/tex">\forall \epsilon > 0</script>，<script type="math/tex">\exists \delta > 0</script>，当<script type="math/tex">0 < |x-a| < \delta</script>时恒有：</p><script type="math/tex; mode=display">|f(x)-A|<\epsilon</script><p>其中<script type="math/tex">A\in R</script>，则称<script type="math/tex">\lim_{x\rightarrow a}f(x)=A</script>，或称<script type="math/tex">x\rightarrow a</script>时，<script type="math/tex">f_{(x)}</script>有有限极限A。</p><ul><li><p>单侧极限</p><p>若对<script type="math/tex">\forall \epsilon > 0</script>，<script type="math/tex">\exists \delta > 0</script>，当<script type="math/tex">0<x-a<\delta</script>时恒有：</p><script type="math/tex; mode=display">|f(x)-A|<\epsilon</script><p>其中<script type="math/tex">A\in R</script>，则称<script type="math/tex">\lim_{x\rightarrow a^+}f(x)=A</script>，简记为<script type="math/tex">f_{(a^+)}=A</script>。</p><p><strong>左极限同理。</strong></p></li></ul></li><li><p>数列的极限</p><p>若<script type="math/tex">\forall \epsilon > 0</script>，<script type="math/tex">\exists N \in N</script>，当<script type="math/tex">n>N</script>时恒有：</p><script type="math/tex; mode=display">|x_n-A|<\epsilon</script><p>其中<script type="math/tex">A\in R</script>，则称<script type="math/tex">\lim_{n\rightarrow \infty}x_n=A</script>，或称<script type="math/tex">\{x_n\}</script>收敛于<script type="math/tex">A</script>。</p><p><u>数列不存在某点的极限，因为其本身不是连续型。</u></p></li><li><p>夹逼准则</p><p>若函数<script type="math/tex">f(x)</script>，<script type="math/tex">g(x)</script>，<script type="math/tex">h(x)</script>在<script type="math/tex">x=a</script>的某<em>去心邻域<script type="math/tex">I</script></em>内有定义，且<script type="math/tex">\forall x \in I</script>都有</p><script type="math/tex; mode=display">g_{(x)}\le f_{(x)} \le h_{(x)}</script><p>若：</p><script type="math/tex; mode=display">\lim_{x\rightarrow a}g(x) = \lim_{x\rightarrow a}h(x) = A (or \pm \infty)</script><p>则：</p><script type="math/tex; mode=display">\lim_{x\rightarrow a}f_{(x)} = A(or \pm \infty)</script></li><li><p>单调有界收敛准则</p><p>若数列<script type="math/tex">\{x_n\}</script>单调增有上界，或单调减有下界，则<script type="math/tex">\{x_n\}</script>必定收敛，即<script type="math/tex">\exists A \in R</script>，使得</p><script type="math/tex; mode=display">\lim_{n \rightarrow \infty}x_n = A</script></li><li><p>两个重要极限</p><ol><li><script type="math/tex">\lim_{u \rightarrow 0}\frac{sinu}{u} = 1</script>；</li><li><script type="math/tex">\lim_{u \rightarrow 0}(1+u)^{\frac{1}{u}} = e</script>。</li></ol></li><li><p>无穷小的比较</p><p>设<script type="math/tex">x \rightarrow a</script>时，<script type="math/tex">\alpha</script>与<script type="math/tex">\beta</script>都是无穷小，若：</p><p>（1）<script type="math/tex">\frac{\alpha}{\beta} \rightarrow 0</script>，称<script type="math/tex">\alpha</script>是<script type="math/tex">\beta</script>的高阶无穷小，记作<script type="math/tex">\alpha = o(\beta)</script>；</p><p>（2）<script type="math/tex">\frac{\alpha}{\beta} \rightarrow \infty</script>，称<script type="math/tex">\alpha</script>是<script type="math/tex">\beta</script>的低阶无穷小；</p><p>（3）<script type="math/tex">\frac{\alpha}{\beta} \rightarrow c (c \ne 0, c \in R)</script>，称<script type="math/tex">\alpha</script>是<script type="math/tex">\beta</script>的同阶无穷小，特别地，当<script type="math/tex">c=1</script>时，称<script type="math/tex">\alpha</script>是<script type="math/tex">\beta</script>的等价无穷小，记作<script type="math/tex">\alpha \sim \beta</script>；</p><p>（4）<script type="math/tex">\frac{\alpha}{\beta ^ k} \rightarrow c (c \ne 0, c \in R)</script>，称<script type="math/tex">\alpha</script>为<script type="math/tex">\beta</script>的<script type="math/tex">k</script>阶无穷小，且<script type="math/tex">c \beta^k</script>为无穷小<script type="math/tex">\alpha</script>的主部。</p></li><li><p>等价无穷小因子替换法则</p><p>若<script type="math/tex">x \rightarrow a</script>时，<script type="math/tex">\alpha{(x)}</script>与<script type="math/tex">\beta{(x)}</script>为等价无穷小（<script type="math/tex">\alpha{(x)} \sim \beta_{(x)}</script>），<script type="math/tex">\gamma{(x)}</script>与<script type="math/tex">\delta{(x)}</script>为等价无穷小（<script type="math/tex">\gamma{(x)} \sim \delta{(x)}</script>），则有：</p><script type="math/tex; mode=display">\lim_{x \rightarrow a}\frac{\alpha{(x)}f(x)}{\gamma{(x)}g(x)} = \lim_{x \rightarrow a}\frac{\beta{(x)}f(x)}{\delta{(x)}g(x)}</script><p>常见的等价无穷小：</p><p>当<script type="math/tex">u \rightarrow 0</script>时：</p><p>（1）<script type="math/tex">u \sim sinu \sim arcsinu \sim tanu \sim arctanu \sim ln(1+u) \sim e^u-1</script>；</p><p>（2）<script type="math/tex">(1 + u)^{\lambda}-1 \sim \lambda u (\lambda \in R)</script>；</p><p>（3）<script type="math/tex">1-cosu \sim \frac{1}{2}u^2</script>。</p></li></ul><h1 id="连续"><a href="#连续" class="headerlink" title="连续"></a>连续</h1><ul><li><p>函数的连续性</p><p>设函数<script type="math/tex">f(x)</script>在<script type="math/tex">x=a</script>的某邻域内有定义，若：</p><script type="math/tex; mode=display">\lim_{x \rightarrow a}f(x) = f(a)</script><p>则称<script type="math/tex">f(x)</script>在<script type="math/tex">x=a</script>连续。</p><p>若函数在<script type="math/tex">f(x)</script>在区间<script type="math/tex">I</script>上每一点连续，称<script type="math/tex">f</script>在区间<script type="math/tex">I</script>上连续。</p></li><li><p>函数左连续与右连续</p><p>设函数<script type="math/tex">f(x)</script>在<script type="math/tex">x=a</script>的左（右）邻域内有定义，若：</p><script type="math/tex; mode=display">f(a-) = \lim_{x \rightarrow a^-}f(x) = f(a) (f(a+) = \lim_{x \rightarrow a^+}f(x) = f(a))</script><p>称<script type="math/tex">f(x)</script>在<script type="math/tex">x=a</script>左（右）连续。</p><p><strong><script type="math/tex">f(x)</script>在<script type="math/tex">x=a</script>连续的充要条件是<script type="math/tex">f(x)</script>在<script type="math/tex">x=a</script>左连续且右连续。</strong></p></li><li><p>连续函数的运算性质</p><ul><li><p>函数<script type="math/tex">f(x)</script>与<script type="math/tex">g(x)</script>在<script type="math/tex">x=a</script>皆连续，则<script type="math/tex">f(x) \pm g(x)</script>，<script type="math/tex">f(x) \cdot g(x)</script>，<script type="math/tex">\frac{f(x)}{g(x)}(g(a) \ne 0)</script>在<script type="math/tex">x=a</script>也连续；</p></li><li><p>若<script type="math/tex">f(u)</script>在<script type="math/tex">u=u_0</script>连续，<script type="math/tex">u=\phi(x)</script>在<script type="math/tex">x=x_0</script>连续，且<script type="math/tex">u_0=\phi(x_0)</script>，则<script type="math/tex">f(\phi(x))</script>在<script type="math/tex">x=x_0</script>连续，即：</p><script type="math/tex; mode=display">\lim_{x\rightarrow x_0}f(\phi(x)) = f(\lim_{x\rightarrow x_0}\phi(x)) = f(\phi(x_0))</script></li></ul></li><li><p>间断点分类</p><p>若函数<script type="math/tex">f(x)</script>在<script type="math/tex">x=a</script>不连续，则称<script type="math/tex">x=a</script>为<script type="math/tex">f(x)</script>的间断点，间断点可以分为两类：</p><ul><li>当<script type="math/tex">f(a-)</script>和<script type="math/tex">f(a+)</script>皆为有限数的时候，称<script type="math/tex">x=a</script>为第一类间断点；<ul><li>若<script type="math/tex">f(a-)=f(a+)</script>，则称<script type="math/tex">x=a</script>为可去型；</li><li>若<script type="math/tex">f(a-) \ne f(a+)</script>，则称<script type="math/tex">x=a</script>为跳跃型；</li></ul></li><li>当<script type="math/tex">f(a-)</script>和<script type="math/tex">f(a+)</script>中有一个不为有限数时，称<script type="math/tex">x=a</script>为第二类间断点；<ul><li>若<script type="math/tex">f(a-)</script>和<script type="math/tex">f(a+)</script>中有一个等于<script type="math/tex">\infty</script>时，则称<script type="math/tex">x=a</script>为无穷型。</li></ul></li></ul></li><li><p>闭区间上连续函数的性质</p><ul><li><p><strong>有界定理</strong>    若函数<script type="math/tex">f(x)</script>在<script type="math/tex">[a,b]</script>连续，则<script type="math/tex">\exists K>0</script>，使得：</p><script type="math/tex; mode=display">|f(x)|\le K, \forall x \in [a,b]</script></li><li><p><strong>最值定理</strong>    若函数<script type="math/tex">f(x)</script>在<script type="math/tex">[a,b]</script>连续，则<script type="math/tex">\exists x_1, x_2 \in [a,b]</script>，使得：</p><script type="math/tex; mode=display">f(x_1)\le f(x)\le f(x_2), \forall x \in [a,b]</script></li><li><p><strong>介值定理</strong>    若函数<script type="math/tex">f(x)</script>在<script type="math/tex">[a,b]</script>连续，<script type="math/tex">f(a)<f(b)</script>，则<script type="math/tex">\forall \mu \in (f(a),f(b))</script>，必<script type="math/tex">\exists \epsilon \in (a,b)</script>，使得：</p><script type="math/tex; mode=display">f(\epsilon) = \mu</script></li><li><p><strong>零点定理</strong>    若函数<script type="math/tex">f(x)</script>在<script type="math/tex">[a,b]</script>连续，<script type="math/tex">f(a)f(b)<0</script>，则<script type="math/tex">\exists \epsilon \in (a,b)</script>使得：</p><script type="math/tex; mode=display">f(\epsilon) = 0</script><p>称<script type="math/tex">\epsilon</script>为<script type="math/tex">f(x)</script>的零点。</p></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Advanced math </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Advanced math </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Dimension Reduction and High dimensional Data Visualization</title>
      <link href="/2023/08/28/pca/"/>
      <url>/2023/08/28/pca/</url>
      
        <content type="html"><![CDATA[<p>生物本身就是一个复杂的体系，我们必须使用多维数据来对之进行准确描述，而这一点在生物信息学领域体现的尤为突出，以经典的转录组数据为例：</p><ul><li>bulk RNA-seq作为一种经典的基因相对表达量定量方法广泛应用于各种研究中，如果我们在一个课题中对4个样品进行了bulk RNA-seq测序，那么我们将得到一个4*N维的矩阵，这里N就是全基因组范围内能转录的基因。</li><li>scRNA-seq是近十年来蓬勃发展的一种分辨率更高的RNA-seq，如果我们进行测序的组织样本中含有10000个细胞，那么我们在最后将得到一个10000*N维的矩阵。</li></ul><p>数据纷繁复杂，我们不可能将所有的数据都进行分析，无论是从时间和空间上都是不现实的，因此在生物信息学（尤其是NGS组学）中数据降维几乎是一个无法逃避的主题。</p><p>那么究竟什么是数据降维呢？简单来说就是只保留那些在不同的组别（对bulk RNA-seq而言就是不同的样本，对scRNA-seq而言就是不同的细胞）中具有较大差异的特征，而舍弃掉那些非常“均一”的特征，所谓“拨云见日”。</p><p>数据降维究竟有什么实际应用呢？一个最简单的应用就是找到一个群体中相似的个体，而这一点也被大家广泛地应用到NGS测序数据质量评估中：一般而言，我们会给同一个生物学条件下准备多个生物学重复，我们更期待不同样品的组内差异小于组间差异，只有这样才能说明我们的数据可重复性好，实验条件更加稳定。</p><h1 id="1-常见数据降维方法"><a href="#1-常见数据降维方法" class="headerlink" title="1 常见数据降维方法"></a>1 常见数据降维方法</h1><p>生物学中的数据降维方法都是从机器学习领域借鉴过来的，目前常用的主要包括线性降维的PCA（principal component analysis，主成分分析）、非线性降维的tSNE（t-Distribution Stochastic Neighbour Embedding）与UMAP（Uniform Manifold Approximation and Projection for Dimension Reduction）等。</p><ul><li>PCA：</li></ul><p><a href="https://book.ncrnalab.org/teaching/。" title="清华大学鲁志实验室Bioinformatics Tutorial">PCA的主要思想是找到k组线性组合，将n维特征投影到k维上，使得新的k维特征彼此正交，并且可以尽可能多的解释数据中的variation。这样得到新的k维特征就被称为k个主成分。k个主成分实际上对应着我们从输入数据估计出的协方差矩阵最大的k个特征值对应的特征向量。</a>PCA在在生物信息学分析中，是样本量不多的bulk RNA-seq转录组的可视化最常用的方法。</p><p>为了便于让大家更好的简单理解什么是PCA，在这里我用两张PPT做简单说明：</p><p><img src="https://files.mdnice.com/user/41526/3e86e7e1-be66-42c0-9807-f98615bd354a.png" alt=""></p><p><img src="https://files.mdnice.com/user/41526/127f14dc-0d59-4452-b38e-91c959362d4f.png" alt=""></p><ul><li>tSNE与UMAP</li></ul><p>t-SNE与UMAP主要的优势就是保持非线性的局部结构的能力，比较适用于样本量较大，样本之间相互关系比较复杂的数据，所以在单细胞转录组的可视化中有大量应用。需要注意的是，这两种将为的方法通常只应用于数据的可视化。</p><h1 id="2-代码实现"><a href="#2-代码实现" class="headerlink" title="2 代码实现"></a>2 代码实现</h1><p>在本部分我将从数据的预处理到降维分析可视化的过程用R语言进行展示。</p><h2 id="2-1-数据预处理"><a href="#2-1-数据预处理" class="headerlink" title="2.1 数据预处理"></a>2.1 数据预处理</h2><p>在进行降维分析之前，首先必须要做的一个工作就是数据的预处理，其中非常关键的一步就是scale（有时可以翻译为“归一化”）。简单来说，未经处理的数据可能具有非常大的变异度，这可能会对后续的分析产生影响，具体来说，以RNA-seq为例：不同的基因具有不同的表达水平，有些基因表达水平很高，有的很低；同一个基因在不同的生物学条件下表达的差异也不同，有的“岿然不动”，有的“闻风而动”，甚至具有非常大的差异。用鲁志老师的tutorial来说，对涉及距离计算的模型而言，在实际应用中，不同特征的数值大小不同，会在求距离时造成很大的影响。例如，一个基因的表达量很高，另一个基因的表达量很低，如果不进行数据的归一化，表达量高的基因就会主导距离的计算。</p><p>在R语言中我们常用的就是使用z-score里进行归一化：</p><script type="math/tex; mode=display">zscore(x_{ij})=\frac{x_{ij}-\mu_{ij}}{\sigma_i}</script><p>这里我们使用鸢尾花数据集来进行演示，该数据集为R包datasets的一个内置数据集，记录了150朵鸢尾花不同的特征及其种属，一般可以直接加载使用即可：</p><pre class=" language-lang-r"><code class="language-lang-r">head(iris)#  Sepal.Length Sepal.Width Petal.Length Petal.Width Species#1          5.1         3.5          1.4         0.2  setosa#2          4.9         3.0          1.4         0.2  setosa#3          4.7         3.2          1.3         0.2  setosa#4          4.6         3.1          1.5         0.2  setosa#5          5.0         3.6          1.4         0.2  setosa#6          5.4         3.9          1.7         0.4  setosa</code></pre><p>利用R语言的<code>scale()</code>函数进行归一化：</p><pre class=" language-lang-r"><code class="language-lang-r">iris.scale <- scale(as.matrix(iris[, 1:4]),                    scale = TRUE,                    center = TRUE)</code></pre><h2 id="2-2-数据降维"><a href="#2-2-数据降维" class="headerlink" title="2.2 数据降维"></a>2.2 数据降维</h2><h3 id="2-2-1-PCA"><a href="#2-2-1-PCA" class="headerlink" title="2.2.1 PCA"></a>2.2.1 PCA</h3><p>首先是PCA，这里介绍两种方法，分别基于stats包的<code>prcomp()</code>函数与FactoMineR包的<code>PCA()</code>函数。</p><pre class=" language-lang-r"><code class="language-lang-r">#use prcomp()pca.res <- prcomp(iris.scale, scale. = FALSE, center = FALSE)#set FALSE, because we have already doneplot.data <- cbind(as.data.frame(pca.res$x[, 1:2]),                   Species = iris$Species)library(ggplot2)ggplot(data = plot.data, aes(PC1, PC2)) +  geom_point(aes(color = Species)) +  theme_test()</code></pre><p><img src="https://files.mdnice.com/user/41526/a01dff3d-7c1f-4c32-a7c6-1ff9ad7bfe25.png" alt=""><br>我们可以看到同一个物种的不同个体基本都被聚在了一起，而不同物种之间“泾渭分明”。（versicolor和virginica未被很好分开是因为这两个物种本身就具有相似的特征）</p><pre class=" language-lang-r"><code class="language-lang-r">#use PCA()#install.packages('factoextra')#install.packages('FactoMineR')library(factoextra)library(FactoMineR)pca.res <- PCA(iris.scale,                scale.unit = TRUE,               graph = FALSE)fviz_pca_ind(pca.res,             geom = 'point',             habillage = iris$Species,             addEllipses = TRUE) +  theme_test()</code></pre><p><img src="https://files.mdnice.com/user/41526/965ee887-25f2-483e-a6bb-bdf1a1c7e0d8.png" alt=""><br>结果类似，不过看起来好像PC2反过来了。可以看到这里有两个数字：73%和22.9%，你可以简单理解为每个主成分能够解释的数据变异度比例，根据前面的PPT，理论上来讲PC1解释度最高，PC2次之……所以我们尝试看一下PC3和PC4对鸢尾花个体的区分度如何：</p><pre class=" language-lang-r"><code class="language-lang-r">fviz_pca_ind(pca.res,             axes = c(3, 4),             geom = 'point',             habillage = iris$Species,             addEllipses = TRUE) +  theme_test()</code></pre><p><img src="https://files.mdnice.com/user/41526/0b239888-92d4-49f0-b28e-cb36c462a069.png" alt=""><br>可以说基本没有分开原因就在于这两个主成分没有很好的解释整个数据集的变异度（3.7%，0.5%）。</p><p>看吧，所以我们可以用这种PCA的方法来检验bulk RNA-seq不同生物学条件下的不同生物学重复的相似性和差异性，当然DESeq2这个包本身也可以帮你来绘制PCA图，但我们还是要理解背后的原理。</p><h3 id="2-2-2-tSNE"><a href="#2-2-2-tSNE" class="headerlink" title="2.2.2 tSNE"></a>2.2.2 tSNE</h3><pre class=" language-lang-r"><code class="language-lang-r">#install.packages('Rtsne')library(Rtsne)tsne.res <- Rtsne(iris.scale, check_duplicates = FALSE)plot.data <- cbind(as.data.frame(tsne.res$Y[, 1:2]),                   Species = iris$Species)colnames(plot.data)[1:2] <- c('tSNE_1', 'tSNE_2')ggplot(data = plot.data, aes(tSNE_1, tSNE_2)) +  geom_point(aes(color = Species)) +  theme_test()</code></pre><p><img src="https://files.mdnice.com/user/41526/ef427c8c-7d60-4f31-96bb-c67d45f1900d.png" alt=""></p><p>可以看到相同物种的不同样本被很好的聚在了一起。</p><h3 id="2-2-3-UMAP"><a href="#2-2-3-UMAP" class="headerlink" title="2.2.3 UMAP"></a>2.2.3 UMAP</h3><pre class=" language-lang-r"><code class="language-lang-r">#install.packages('umap')library(umap)umap.res <- umap(iris.scale)plot.data <- cbind(as.data.frame(umap.res$layout[, 1:2]),                   Species = iris$Species)colnames(plot.data)[1:2] <- c('UMAP_1', 'UMAP_2')ggplot(data = plot.data, aes(UMAP_1, UMAP_2)) +  geom_point(aes(color = Species)) +  theme_test()</code></pre><p><img src="https://files.mdnice.com/user/41526/66988b00-4895-49dc-865a-51c8aefd3042.png" alt=""></p><h1 id="3-写在最后"><a href="#3-写在最后" class="headerlink" title="3 写在最后"></a>3 写在最后</h1><p>推荐一个学习网站：清华大学鲁志实验室的Bioinformatics Tutorial，点击原文即可跳转哦！</p>]]></content>
      
      
      <categories>
          
          <category> Advanced math </category>
          
          <category> R </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Advanced math </tag>
            
            <tag> R </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
