<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>pca</title>
      <link href="/2023/08/28/pca/"/>
      <url>/2023/08/28/pca/</url>
      
        <content type="html"><![CDATA[<p>生物本身就是一个复杂的体系，我们必须使用多维数据来对之进行准确描述，而这一点在生物信息学领域体现的尤为突出，以经典的转录组数据为例：</p><ul><li>bulk RNA-seq作为一种经典的基因相对表达量定量方法广泛应用于各种研究中，如果我们在一个课题中对4个样品进行了bulk RNA-seq测序，那么我们将得到一个4*N维的矩阵，这里N就是全基因组范围内能转录的基因。</li><li>scRNA-seq是近十年来蓬勃发展的一种分辨率更高的RNA-seq，如果我们进行测序的组织样本中含有10000个细胞，那么我们在最后将得到一个10000*N维的矩阵。</li></ul><p>数据纷繁复杂，我们不可能将所有的数据都进行分析，无论是从时间和空间上都是不现实的，因此在生物信息学（尤其是NGS组学）中数据降维几乎是一个无法逃避的主题。</p><p>那么究竟什么是数据降维呢？简单来说就是只保留那些在不同的组别（对bulk RNA-seq而言就是不同的样本，对scRNA-seq而言就是不同的细胞）中具有较大差异的特征，而舍弃掉那些非常“均一”的特征，所谓“拨云见日”。</p><p>数据降维究竟有什么实际应用呢？一个最简单的应用就是找到一个群体中相似的个体，而这一点也被大家广泛地应用到NGS测序数据质量评估中：一般而言，我们会给同一个生物学条件下准备多个生物学重复，我们更期待不同样品的组内差异小于组间差异，只有这样才能说明我们的数据可重复性好，实验条件更加稳定。</p><blockquote><h1 id="1-常见数据降维方法"><a href="#1-常见数据降维方法" class="headerlink" title="1. 常见数据降维方法"></a>1. 常见数据降维方法</h1></blockquote><p>生物学中的数据降维方法都是从机器学习领域借鉴过来的，目前常用的主要包括线性降维的PCA（principal component analysis，主成分分析）、非线性降维的tSNE（t-Distribution Stochastic Neighbour Embedding）与UMAP（Uniform Manifold Approximation and Projection for Dimension Reduction）等。</p><ul><li>PCA：</li></ul><p><a href="https://book.ncrnalab.org/teaching/%E3%80%82" title="清华大学鲁志实验室Bioinformatics Tutorial">PCA的主要思想是找到k组线性组合，将n维特征投影到k维上，使得新的k维特征彼此正交，并且可以尽可能多的解释数据中的variation。这样得到新的k维特征就被称为k个主成分。k个主成分实际上对应着我们从输入数据估计出的协方差矩阵最大的k个特征值对应的特征向量。</a>PCA在在生物信息学分析中，是样本量不多的bulk RNA-seq转录组的可视化最常用的方法。</p><p>为了便于让大家更好的简单理解什么是PCA，在这里我用两张PPT做简单说明：</p><p><img src="https://files.mdnice.com/user/41526/3e86e7e1-be66-42c0-9807-f98615bd354a.png"></p><p><img src="https://files.mdnice.com/user/41526/127f14dc-0d59-4452-b38e-91c959362d4f.png"></p><ul><li>tSNE与UMAP</li></ul><p>t-SNE与UMAP主要的优势就是保持非线性的局部结构的能力，比较适用于样本量较大，样本之间相互关系比较复杂的数据，所以在单细胞转录组的可视化中有大量应用。需要注意的是，这两种将为的方法通常只应用于数据的可视化。</p><blockquote><h1 id="2-代码实现"><a href="#2-代码实现" class="headerlink" title="2. 代码实现"></a>2. 代码实现</h1></blockquote><p>在本部分我将从数据的预处理到降维分析可视化的过程用R语言进行展示。</p><ul><li><h3 id="数据预处理"><a href="#数据预处理" class="headerlink" title="数据预处理"></a>数据预处理</h3></li></ul><p>在进行降维分析之前，首先必须要做的一个工作就是数据的预处理，其中非常关键的一步就是scale（有时可以翻译为“归一化”）。简单来说，未经处理的数据可能具有非常大的变异度，这可能会对后续的分析产生影响，具体来说，以RNA-seq为例：不同的基因具有不同的表达水平，有些基因表达水平很高，有的很低；同一个基因在不同的生物学条件下表达的差异也不同，有的“岿然不动”，有的“闻风而动”，甚至具有非常大的差异。用鲁志老师的tutorial来说，对涉及距离计算的模型而言，在实际应用中，不同特征的数值大小不同，会在求距离时造成很大的影响。例如，一个基因的表达量很高，另一个基因的表达量很低，如果不进行数据的归一化，表达量高的基因就会主导距离的计算。</p><p>在R语言中我们常用的就是使用z-score里进行归一化：<br>$$<br>zscore(x_{ij})&#x3D;\frac{x_{ij}-\mu_{ij}}{\sigma_i}<br>$$<br>这里我们使用鸢尾花数据集来进行演示，该数据集为R包datasets的一个内置数据集，记录了150朵鸢尾花不同的特征及其种属，一般可以直接加载使用即可：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">head<span class="punctuation">(</span>iris<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span><br><span class="line"><span class="comment">#1          5.1         3.5          1.4         0.2  setosa</span></span><br><span class="line"><span class="comment">#2          4.9         3.0          1.4         0.2  setosa</span></span><br><span class="line"><span class="comment">#3          4.7         3.2          1.3         0.2  setosa</span></span><br><span class="line"><span class="comment">#4          4.6         3.1          1.5         0.2  setosa</span></span><br><span class="line"><span class="comment">#5          5.0         3.6          1.4         0.2  setosa</span></span><br><span class="line"><span class="comment">#6          5.4         3.9          1.7         0.4  setosa</span></span><br></pre></td></tr></table></figure><p>利用R语言的<code>scale()</code>函数进行归一化：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iris.scale <span class="operator">&lt;-</span> scale<span class="punctuation">(</span>as.matrix<span class="punctuation">(</span>iris<span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                    scale <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span></span><br><span class="line">                    center <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><ul><li><h3 id="数据降维"><a href="#数据降维" class="headerlink" title="数据降维"></a>数据降维</h3></li></ul><h4 id="1-PCA"><a href="#1-PCA" class="headerlink" title="1. PCA"></a>1. PCA</h4><p>首先是PCA，这里介绍两种方法，分别基于stats包的<code>prcomp()</code>函数与FactoMineR包的<code>PCA()</code>函数。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#use prcomp()</span></span><br><span class="line">pca.res <span class="operator">&lt;-</span> prcomp<span class="punctuation">(</span>iris.scale<span class="punctuation">,</span> scale. <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> center <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#set FALSE, because we have already done</span></span><br><span class="line">plot.data <span class="operator">&lt;-</span> cbind<span class="punctuation">(</span>as.data.frame<span class="punctuation">(</span>pca.res<span class="operator">$</span>x<span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                   Species <span class="operator">=</span> iris<span class="operator">$</span>Species<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> plot.data<span class="punctuation">,</span> aes<span class="punctuation">(</span>PC1<span class="punctuation">,</span> PC2<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> Species<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_test<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p><img src="https://files.mdnice.com/user/41526/a01dff3d-7c1f-4c32-a7c6-1ff9ad7bfe25.png"><br>我们可以看到同一个物种的不同个体基本都被聚在了一起，而不同物种之间“泾渭分明”。（versicolor和virginica未被很好分开是因为这两个物种本身就具有相似的特征）</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#use PCA()</span></span><br><span class="line"><span class="comment">#install.packages(&#x27;factoextra&#x27;)</span></span><br><span class="line"><span class="comment">#install.packages(&#x27;FactoMineR&#x27;)</span></span><br><span class="line">library<span class="punctuation">(</span>factoextra<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>FactoMineR<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">pca.res <span class="operator">&lt;-</span> PCA<span class="punctuation">(</span>iris.scale<span class="punctuation">,</span> </span><br><span class="line">               scale.unit <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span></span><br><span class="line">               graph <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">fviz_pca_ind<span class="punctuation">(</span>pca.res<span class="punctuation">,</span></span><br><span class="line">             geom <span class="operator">=</span> <span class="string">&#x27;point&#x27;</span><span class="punctuation">,</span></span><br><span class="line">             habillage <span class="operator">=</span> iris<span class="operator">$</span>Species<span class="punctuation">,</span></span><br><span class="line">             addEllipses <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_test<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p><img src="https://files.mdnice.com/user/41526/965ee887-25f2-483e-a6bb-bdf1a1c7e0d8.png"><br>结果类似，不过看起来好像PC2反过来了。可以看到这里有两个数字：73%和22.9%，你可以简单理解为每个主成分能够解释的数据变异度比例，根据前面的PPT，理论上来讲PC1解释度最高，PC2次之……所以我们尝试看一下PC3和PC4对鸢尾花个体的区分度如何：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">fviz_pca_ind<span class="punctuation">(</span>pca.res<span class="punctuation">,</span></span><br><span class="line">             axes <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">             geom <span class="operator">=</span> <span class="string">&#x27;point&#x27;</span><span class="punctuation">,</span></span><br><span class="line">             habillage <span class="operator">=</span> iris<span class="operator">$</span>Species<span class="punctuation">,</span></span><br><span class="line">             addEllipses <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_test<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p><img src="https://files.mdnice.com/user/41526/0b239888-92d4-49f0-b28e-cb36c462a069.png"><br>可以说基本没有分开原因就在于这两个主成分没有很好的解释整个数据集的变异度（3.7%，0.5%）。</p><p>看吧，所以我们可以用这种PCA的方法来检验bulk RNA-seq不同生物学条件下的不同生物学重复的相似性和差异性，当然DESeq2这个包本身也可以帮你来绘制PCA图，但我们还是要理解背后的原理。</p><h4 id="2-tSNE"><a href="#2-tSNE" class="headerlink" title="2. tSNE"></a>2. tSNE</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#install.packages(&#x27;Rtsne&#x27;)</span></span><br><span class="line">library<span class="punctuation">(</span>Rtsne<span class="punctuation">)</span></span><br><span class="line">tsne.res <span class="operator">&lt;-</span> Rtsne<span class="punctuation">(</span>iris.scale<span class="punctuation">,</span> check_duplicates <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">plot.data <span class="operator">&lt;-</span> cbind<span class="punctuation">(</span>as.data.frame<span class="punctuation">(</span>tsne.res<span class="operator">$</span>Y<span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                   Species <span class="operator">=</span> iris<span class="operator">$</span>Species<span class="punctuation">)</span></span><br><span class="line">colnames<span class="punctuation">(</span>plot.data<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;tSNE_1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;tSNE_2&#x27;</span><span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> plot.data<span class="punctuation">,</span> aes<span class="punctuation">(</span>tSNE_1<span class="punctuation">,</span> tSNE_2<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> Species<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_test<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p><img src="https://files.mdnice.com/user/41526/ef427c8c-7d60-4f31-96bb-c67d45f1900d.png"></p><p>可以看到相同物种的不同样本被很好的聚在了一起。</p><h4 id="3-UMAP"><a href="#3-UMAP" class="headerlink" title="3. UMAP"></a>3. UMAP</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#install.packages(&#x27;umap&#x27;)</span></span><br><span class="line">library<span class="punctuation">(</span>umap<span class="punctuation">)</span></span><br><span class="line">umap.res <span class="operator">&lt;-</span> umap<span class="punctuation">(</span>iris.scale<span class="punctuation">)</span></span><br><span class="line">plot.data <span class="operator">&lt;-</span> cbind<span class="punctuation">(</span>as.data.frame<span class="punctuation">(</span>umap.res<span class="operator">$</span>layout<span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                   Species <span class="operator">=</span> iris<span class="operator">$</span>Species<span class="punctuation">)</span></span><br><span class="line">colnames<span class="punctuation">(</span>plot.data<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;UMAP_1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;UMAP_2&#x27;</span><span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> plot.data<span class="punctuation">,</span> aes<span class="punctuation">(</span>UMAP_1<span class="punctuation">,</span> UMAP_2<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> Species<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_test<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p><img src="https://files.mdnice.com/user/41526/66988b00-4895-49dc-865a-51c8aefd3042.png"></p><blockquote><h1 id="3-写在最后"><a href="#3-写在最后" class="headerlink" title="3. 写在最后"></a>3. 写在最后</h1></blockquote><p>推荐一个学习网站：清华大学鲁志实验室的Bioinformatics Tutorial，点击原文即可跳转哦！</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>test</title>
      <link href="/2023/08/28/test/"/>
      <url>/2023/08/28/test/</url>
      
        <content type="html"><![CDATA[<p>This is just a test!</p>]]></content>
      
      
      <categories>
          
          <category> test </category>
          
      </categories>
      
      
        <tags>
            
            <tag> just a test </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2023/08/27/hello-world/"/>
      <url>/2023/08/27/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
